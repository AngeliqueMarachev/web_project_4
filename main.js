!function(){"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t{constructor(t,s,r,n,i,o){e(this,"removeCard",(()=>{this._cardElement.remove(),this._cardElement=null})),e(this,"_setEventListeners",(()=>{this._cardLikeButton.addEventListener("click",(()=>this._handleLikeIcon())),this._deleteCardButton.addEventListener("click",(()=>this._handleDeleteClick())),this._cardImage.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))})),e(this,"createCardElement",(()=>{const e=document.querySelector(this._cardTemplateSelector).content.querySelector(".gallery__card");return this._cardElement=e.cloneNode(!0),this._cardImage=this._cardElement.querySelector(".gallery__item"),this._cardName=this._cardElement.querySelector(".gallery__text"),this._cardLikeButton=this._cardElement.querySelector(".gallery__heart-icon"),this._deleteCardButton=this._cardElement.querySelector(".gallery__delete-button"),this._likeCounter=this._cardElement.querySelector(".gallery__likes"),this._cardImage.src=this._link,this._cardImage.alt="".concat(this._name),this._cardName.textContent=this._name,this._setEventListeners(),this.setLikes(this._likes),this._userId!==this._ownerId&&(this._deleteCardButton.style.display="none"),this._cardElement})),this._data=t,this._name=t.name,this._link=t.link,this._likes=t.likes,this._id=t._id,this._userId=r,this._ownerId=t.owner._id,this._cardTemplateSelector=s,this._handleCardClick=n,this._handleDeleteClick=i,this._handleLikeIcon=o}getId(){return this._id}setLikes(e){this._likes=e;const t=this._likes.length;this._cardLikeButton.textContent=t,this.isLiked()?this._cardLikeButton.classList.add("gallery__heart-icon_clicked"):this._cardLikeButton.classList.remove("gallery__heart-icon_clicked")}isLiked(){return this._likes.find((e=>e._id===this._userId))}}function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e,t){s(this,"_showInputError",((e,t)=>{const{inputErrorClass:s,errorClass:r}=this._settings,n=this._formEl.querySelector("#".concat(e.id,"-error"));e.classList.add(r),n.classList.add(s),n.textContent=t})),s(this,"_hideInputError",(e=>{const{inputErrorClass:t,errorClass:s}=this._settings,r=this._formEl.querySelector("#".concat(e.id,"-error"));e.classList.remove(s),r.classList.remove(t),r.textContent=""})),s(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),s(this,"_toggleButton",(()=>{this._isFormValid()?this._enableButton():this.disableButton()})),s(this,"disableButton",(()=>{this._submitButton.classList.add(this._settings.inactiveButtonClass),this._submitButton.disabled=!0})),s(this,"_enableButton",(()=>{this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1})),s(this,"_isFormValid",(()=>this._inputList.every((e=>e.validity.valid)))),s(this,"_setEventListeners",(()=>{this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))})),this._settings=e,this._formEl=t,this._inputList=Array.from(this._formEl.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._formEl.querySelector(this._settings.submitButtonSelector)}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButton()}enableValidation(){this._formEl.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class i{constructor(e){n(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),n(this,"_handleOverlayClose",(e=>{e.target.classList.contains("popup_open")&&this.close()})),this._popupElement=document.querySelector(e),this._button=this._popupElement.querySelector(".popup__button")}open(){this._popupElement.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleOverlayClose)}close(){this._popupElement.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleOverlayClose)}setEventListeners(){this._popupElement.querySelector(".popup__close").addEventListener("mousedown",(()=>{this.close()}))}}class o extends i{constructor(e,t){super(e),this._form=this._popupElement.querySelector(".popup__form"),this._button=this._popupElement.querySelector(".popup__button"),this._handleFormSubmit=t,this._inputs=Array.from(this._form.querySelectorAll(".popup__input"))}_getInputValues(){const e={};return this._inputs.forEach((t=>{const s=t.name,r=t.value;e[s]=r})),e}changeButtonText(e){this._button.textContent=e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){this._form.reset(),super.close()}}const a={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},l=document.querySelector(".profile__edit-button"),c=document.querySelector(".popup__form-edit"),h=document.querySelector(".profile__add-button"),u=(document.querySelector(".profile__name"),document.querySelector(".profile__occupation"),document.querySelector(".profile__avatar-container")),_=c.querySelector(".popup__input_type_name"),d=c.querySelector(".popup__input_type_occupation"),p=(document.querySelector(".popup_type_profile"),document.querySelector(".popup__form-create")),m=(document.querySelector(".popup__close_profile"),document.querySelector(".gallery__grid"),document.querySelector(".popup_type_preview")),v=(m.querySelector(".popup__image"),m.querySelector(".popup__text"),document.querySelector(".popup_type_avatar-change"));document.getElementById(".logo");const y=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject("".concat(e.status," error!"))}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((e=>this._checkResponse(e)))}getUserInfo(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((e=>this._checkResponse(e)))}editProfile(e){let{name:t,about:s}=e;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then((e=>this._checkResponse(e)))}getProfile(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((e=>this._checkResponse(e)))}addCard(e){let{name:t,link:s}=e;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then((e=>this._checkResponse(e)))}likeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((e=>this._checkResponse(e)))}removeLike(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((e=>this._checkResponse(e)))}editAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((e=>this._checkResponse(e)))}deleteCard(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((e=>this._checkResponse(e)))}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"42b9ea6f-407e-4ca1-96e0-0f09ff65d270","Content-Type":"application/json"}});let E;const f=new class{constructor(e){let{userNameSelector:t,userOccupationSelector:s,userAvatarSelector:r}=e;this._profileName=document.querySelector(t),this._profileOccupation=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{user:this._profileName.textContent,occupation:this._profileOccupation.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{user:t,occupation:s,avatar:r}=e;this._profileName.textContent=t||this._name,this._profileOccupation.textContent=s||this._occupation}setUserAvatar(e){this._avatarElement.src=e||this._avatar}setAvatarVisible(){this._avatarElement.style.visibility="visible"}}({userNameSelector:".profile__name",userOccupationSelector:".profile__occupation",userAvatarSelector:".profile__avatar"});Promise.all([y.getUserInfo(),y.getInitialCards()]).then((e=>{let[t,s]=e;E=t._id,f.setUserAvatar(t),f.setUserAvatar(t.avatar),L.renderItems(s)})).then((()=>f.setAvatarVisible())).catch(console.log);const g=new r(a,c);g.enableValidation();const b=new r(a,p);b.enableValidation();const S=new r(a,v);S.enableValidation();const k=e=>{const s=new t(e,"#gallery-template",E,((e,t)=>{C.open(e,t)}),(()=>{w.open(s)}),(()=>{s.isLiked()?y.removeLike(s.getId()).then((e=>{s.setLikes(e.likes)})).catch(console.log):y.likeCard(s.getId()).then((e=>{s.setLikes(e.likes)})).catch(console.log)}));L.addItem(s.createCardElement())},L=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:k},".gallery__grid"),C=new class extends i{constructor(e){super(e),this._image=this._popupElement.querySelector(".popup__image"),this._imageCaption=this._popupElement.querySelector(".popup__text")}open(e,t){super.open(),this._image.src=t,this._image.alt=e,this._imageCaption.textContent=e}}(".popup_type_preview"),q=new o(".popup_type_profile",(e=>{q.changeButtonText("Saving..."),y.editProfile({name:e.user,about:e.occupation}).then((e=>{f.setUserInfo({user:e.name,occupation:e.about}),q.close()})).catch(console.log).finally((()=>{q.changeButtonText("Save")}))})),I=new o(".popup_type_add-card",(e=>{I.changeButtonText("Saving..."),y.addCard({name:e.name,link:e.link}).then((e=>{k(e),I.close()})).catch(console.log).finally((()=>{I.changeButtonText("Save")}))})),B=new o(".popup_type_avatar-change",(e=>{B.changeButtonText("Saving..."),y.editAvatar(e).then((e=>{f.setUserAvatar(e.avatar),B.close()})).catch(console.log).finally((()=>{B.changeButtonText("Save")}))})),w=new class extends i{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super(t),this._form=this._popupElement.querySelector(".popup__form"),this._button=this._popupElement.querySelector(".popup__button"),this._handleFormSubmit=s}open(e){super.open(),this._button.textContent="Yes",this._card=e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._button.textContent="Deleting...",this._handleFormSubmit(this._card)}))}}({popupSelector:".popup_type_confirm-delete",handleFormSubmit:e=>{y.deleteCard(e.getId()).then((()=>{e.removeCard()})).catch(console.log).finally((()=>{w.close()}))}});l.addEventListener("click",(()=>{q.open();const e=f.getUserInfo();_.value=e.user,d.value=e.occupation,g.resetValidation(),g.disableButton()})),h.addEventListener("click",(()=>{I.open(),b.resetValidation(),b.disableButton()})),u.addEventListener("click",(()=>{B.open(),S.resetValidation()})),q.setEventListeners(),I.setEventListeners(),C.setEventListeners(),B.setEventListeners(),w.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjlGLHFCQUdyQjhHLEVBQWlCN0Ysb0JBQ2pCK0YsRUFBZ0IvRixvQkFDaEJnRixFQUFrQmhGLG9CQUNsQmdHLEVBQWtCaEcsb0JBQ2xCaUYsRUFBbUJqRixvQiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHsgXG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLCB1c2VySWQsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlRGVsZXRlQ2xpY2ssIGhhbmRsZUxpa2VJY29uKSB7IFxuXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTsgXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluazsgXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzOyBcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkOyBcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7IFxuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDsgIFxuXG4gICAgdGhpcy5fY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSBjYXJkVGVtcGxhdGVTZWxlY3RvcjsgXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrOyBcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrOyBcbiAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbiA9IGhhbmRsZUxpa2VJY29uOyBcbiAgfSBcblxuICBnZXRJZCgpIHsgXG4gICAgcmV0dXJuIHRoaXMuX2lkOyBcbiAgfTsgXG5cbiAgcmVtb3ZlQ2FyZCA9ICgpID0+IHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbigpKTtcblxuICAgICB0aGlzLl9kZWxldGVDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDbGljaygpKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKSk7XG4gIH07XG5cbiAgc2V0TGlrZXMobmV3TGlrZXMpIHtcbiAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzO1xuXG4gICAgY29uc3QgbGlrZUNvdW50ZXIgPSB0aGlzLl9saWtlcy5sZW5ndGggXG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24udGV4dENvbnRlbnQgPSBsaWtlQ291bnRlcjsgXG5cbiAgICBjb25zdCBjYXJkSXNMaWtlZCA9IHRoaXMuaXNMaWtlZCgpO1xuICAgIGlmKGNhcmRJc0xpa2VkKSB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiZ2FsbGVyeV9faGVhcnQtaWNvbl9jbGlja2VkXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiZ2FsbGVyeV9faGVhcnQtaWNvbl9jbGlja2VkXCIpO1xuICAgIH1cbiAgfVxuXG4gIGlzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLmZpbmQodXNlciA9PiB1c2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgfVxuXG4gICAgY3JlYXRlQ2FyZEVsZW1lbnQgPSAoKSA9PiB7IFxuICAgICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQgXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRUZW1wbGF0ZVNlbGVjdG9yKSBcbiAgICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkXCIpOyBcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTsgXG4gICAgICBcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2l0ZW1cIik7XG4gICAgdGhpcy5fY2FyZE5hbWUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX3RleHRcIik7XG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2hlYXJ0LWljb25cIik7XG4gICAgdGhpcy5fZGVsZXRlQ2FyZEJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fZGVsZXRlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9saWtlQ291bnRlciA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fbGlrZXNcIilcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSBgJHt0aGlzLl9uYW1lfWA7XG4gICAgdGhpcy5fY2FyZE5hbWUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLnNldExpa2VzKHRoaXMuX2xpa2VzKTtcblxuICAgIGlmICh0aGlzLl91c2VySWQgIT09IHRoaXMuX293bmVySWQpIHsgLy8gaWYgbXkgaWQgZG9lcyBub3QgbWF0Y2ggdGhlIG93bmVyIGlkLCBoaWRlIHRoZSB0cmFzaCBpY29uXG4gICAgICB0aGlzLl9kZWxldGVDYXJkQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuX2Zvcm1FbCA9IGZvcm1FbDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIFxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWwsIGVycm9yTWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoZXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gIH07XG5cbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWwpID0+IHtcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XG5cbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoZXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9O1xuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbCkgPT4ge1xuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH1cbiAgfTtcblxuICBfdG9nZ2xlQnV0dG9uID0gKCkgPT4ge1xuICAgXG4gICAgaWYgKHRoaXMuX2lzRm9ybVZhbGlkKCkpIHtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB9XG4gIH07XG5cbiAgZGlzYWJsZUJ1dHRvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9O1xuXG4gIF9lbmFibGVCdXR0b24gPSAoKSA9PiB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH07XG5cbiAgX2lzRm9ybVZhbGlkID0gKCkgPT4ge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xuICB9O1xuXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuICAgIH0pO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiBldnQucHJldmVudERlZmF1bHQoKSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYnV0dG9uXCIpO1xuICAgIH1cbiAgXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIF9oYW5kbGVPdmVybGF5Q2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX29wZW5cIikpIHtcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgXG4gICAgb3BlbigpIHtcbiAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlblwiKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbG9zZSk7XG4gICAgfVxuICBcbiAgICBjbG9zZSgpIHtcbiAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlblwiKTtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbG9zZSk7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICBjb25zdCBwb3B1cENsb3NlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlXCIpO1xuICAgICAgcG9wdXBDbG9zZS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcblxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9pbnB1dHMgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIikpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG5cbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IGlucHV0Lm5hbWU7XG4gICAgICBjb25zdCB2YWx1ZSA9IGlucHV0LnZhbHVlO1xuICAgICAgaW5wdXRWYWx1ZXNba2V5XSA9IHZhbHVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cbiAgY2hhbmdlQnV0dG9uVGV4dCh0ZXh0KSB7XG4gICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gdGV4dDtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgLy8gdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gJ1NhdmluZy4uLic7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG5cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAgICB7XG4gICAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuICAgIH0sXG4gIF07XG4gIFxuICBleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gICAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXG4gIH07XG5cbmV4cG9ydCBjb25zdCBvcGVuUHJvZmlsZU1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1lZGl0XCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZU9jY3VwYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX29jY3VwYXRpb25cIik7XG5leHBvcnQgY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItY29udGFpbmVyXCIpO1xuZXhwb3J0IGNvbnN0IHRpdGxlSW5wdXQgPSBlZGl0UHJvZmlsZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2lucHV0X3R5cGVfbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBkZXNjcmlwdGlvbklucHV0ID0gZWRpdFByb2ZpbGVQb3B1cC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wb3B1cF9faW5wdXRfdHlwZV9vY2N1cGF0aW9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX3Byb2ZpbGVcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1jcmVhdGVcIik7XG5leHBvcnQgY29uc3QgY2xvc2VQcm9maWxlTW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZV9wcm9maWxlXCIpO1xuZXhwb3J0IGNvbnN0IHBsYWNlc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2dyaWRcIik7XG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSBcIiNnYWxsZXJ5LXRlbXBsYXRlXCI7XG5cbmV4cG9ydCBjb25zdCBwb3B1cFNlbGVjdG9yID0gXCJwb3B1cF9vcGVuXCI7XG5leHBvcnQgY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX3ByZXZpZXdcIik7XG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZSA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcbmV4cG9ydCBjb25zdCBwb3B1cFRpdGxlID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3RleHRcIik7XG5cbmV4cG9ydCBjb25zdCBhZGRBdmF0YXJQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hdmF0YXItY2hhbmdlXCIpO1xuXG5leHBvcnQgY29uc3QgbG9nb0ltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiLmxvZ29cIik7XG5cblxuIiwiY2xhc3MgQXBpIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgICAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gICAgfTtcblxuICAgIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgICAgICB7XG4gICAgICAgICAgaWYgKCFyZXMub2spIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgJHtyZXMuc3RhdHVzfSBlcnJvciFgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgICAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xuICAgIH1cblxuICAgIFxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XG4gICAgfVxuXG4gICAgZWRpdFByb2ZpbGUoeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICAgIGFib3V0LFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSkudGhlbihyZXMgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgICB9XG5cbiAgICBnZXRQcm9maWxlKCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XG4gICAgfVxuXG4gICAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICBsaW5rLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSkudGhlbihyZXMgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcbiAgICB9XG5cbiAgICAgbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XG4gICAgIH1cbiAgICBcbiAgICAgcmVtb3ZlTGlrZShjYXJkSWQpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICB9KS50aGVuKHJlcyA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xuICAgIH1cbiAgICBcbiAgICAgZWRpdEF2YXRhcihhdmF0YXIpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGF2YXRhciksXG4gICAgICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XG4gICAgIH1cbiAgICBcbiAgICAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XG4gICAgIH1cbn07XG5cblxuICAgIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXG4gIFxuICBcbiAgLy8gQ29ubmVjdCBBUElcbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcbiAgICBoZWFkZXJzOiB7XG4gICAgICBhdXRob3JpemF0aW9uOiBcIjQyYjllYTZmLTQwN2UtNGNhMS05NmUwLTBmMDlmZjY1ZDI3MFwiLFxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICB9XG59KVxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhTdWJtaXQgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0LmpzXCI7XG5pbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5cbmltcG9ydCB7XG4gIHNldHRpbmdzLFxuICBvcGVuUHJvZmlsZU1vZGFsQnV0dG9uLFxuICBlZGl0UHJvZmlsZVBvcHVwLFxuICBhZGRDYXJkQnV0dG9uLFxuICBjYXJkVGVtcGxhdGVTZWxlY3RvcixcbiAgYWRkQ2FyZFBvcHVwLFxuICB0aXRsZUlucHV0LFxuICBkZXNjcmlwdGlvbklucHV0LFxuICBhZGRBdmF0YXJQb3B1cCxcbiAgYXZhdGFyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxubGV0IHVzZXJJZDtcblxuLy8gVXNlckluZm9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgdXNlck5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLFxuICB1c2VyT2NjdXBhdGlvblNlbGVjdG9yOiBcIi5wcm9maWxlX19vY2N1cGF0aW9uXCIsXG4gIHVzZXJBdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9fYXZhdGFyXCIsXG59KTtcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxuICAudGhlbigoW3VzZXJEYXRhLCBpbml0aWFsQ2FyZHNdKSA9PiB7XG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xuXG4gICAgLy8gdXNlckluZm8uc2V0VXNlckluZm8oeyB1c2VyOiB1c2VyRGF0YS5uYW1lLCBvY2N1cGF0aW9uOiB1c2VyRGF0YS5hYm91dCB9KTsgLy8gY291bGQgSSBqdXN0IHdyaXRlIHVzZXJEYXRhP1xuICAgIC8vIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoeyB1c2VyRGF0YSB9KTtcbiAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YSk7XG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICAgIHNlY3Rpb24ucmVuZGVySXRlbXMoaW5pdGlhbENhcmRzKTtcbiAgfSlcbiAgLnRoZW4oKCkgPT4gdXNlckluZm8uc2V0QXZhdGFyVmlzaWJsZSgpKVxuICAuY2F0Y2goY29uc29sZS5sb2cpO1xuXG5cbi8vIEZvcm0gVmFsaWRhdGlvblxuY29uc3QgdmFsaWRhdGVQcm9maWxlRm9ybSA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBlZGl0UHJvZmlsZVBvcHVwKTtcbnZhbGlkYXRlUHJvZmlsZUZvcm0uZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCB2YWxpZGF0ZVBsYWNlRm9ybSA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhZGRDYXJkUG9wdXApO1xudmFsaWRhdGVQbGFjZUZvcm0uZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCB2YWxpZGF0ZUF2YXRhckZvcm0gPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYWRkQXZhdGFyUG9wdXApO1xudmFsaWRhdGVBdmF0YXJGb3JtLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuLy8gQ3JlYXRlIENhcmRcbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxuICAgIGRhdGEsXG4gICAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXG4gICAgdXNlcklkLFxuICAgIChuYW1lLCBsaW5rKSA9PiB7XG4gICAgICBpbWFnZVByZXZpZXdQb3B1cC5vcGVuKG5hbWUsIGxpbmspO1xuICAgIH0sXG5cbiAgICAoKSA9PiB7XG4gICAgICBjb25maXJtRGVsZXRlUG9wdXAub3BlbihjYXJkRWxlbWVudCk7XG4gICAgICAvLyB3aGVuIHlvdSBvcGVuIHRoaXMgcG9wdXAsIHlvdSBjYWxsIGl0IHdpdGggdGhlIGNhcmQgZnJvbSBQb3B1cFdpdGhTdWJtaXQsXG4gICAgICAvLyBhbmQgaWYgcGVyc29uIGNvbmZpcm1zIGRlbGV0ZSwgeW91ciBoYW5kbGVGb3JtU3VibWl0IGZ1bmN0aW9uIGZyb20gUG9wdXBXaXRoU3VibWl0IGV2ZW50IGxpc3RlbmVyc1xuICAgICAgLy8gd2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgaW5zdGFuY2Ugb2YgdGhlIGNhcmRcbiAgICB9LFxuICAgIFxuICAgICgpID0+IHtcbiAgICAgIGlmIChjYXJkRWxlbWVudC5pc0xpa2VkKCkpIHtcbiAgICAgICAgYXBpLnJlbW92ZUxpa2UoY2FyZEVsZW1lbnQuZ2V0SWQoKSlcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjYXJkRWxlbWVudC5zZXRMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcbiAgICAgICAgXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcGkubGlrZUNhcmQoY2FyZEVsZW1lbnQuZ2V0SWQoKSlcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjYXJkRWxlbWVudC5zZXRMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50LmNyZWF0ZUNhcmRFbGVtZW50KCkpO1xufTtcblxuLy8gLy8gUGxhY2VzIENvbnRhaW5lclxuY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgcmVuZGVyZXI6IHJlbmRlckNhcmQsXG4gIH0sXG4gIFwiLmdhbGxlcnlfX2dyaWRcIlxuKTtcblxuLy8gUG9wdXBzXG5jb25zdCBpbWFnZVByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5wb3B1cF90eXBlX3ByZXZpZXdcIik7XG5cbmNvbnN0IHByb2ZpbGVQb3B1cEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF90eXBlX3Byb2ZpbGVcIiwgKGRhdGEpID0+IHtcbiAgcHJvZmlsZVBvcHVwRm9ybS5jaGFuZ2VCdXR0b25UZXh0KFwiU2F2aW5nLi4uXCIpXG4gICAgYXBpXG4gICAgICAuZWRpdFByb2ZpbGUoeyBuYW1lOiBkYXRhLnVzZXIsIGFib3V0OiBkYXRhLm9jY3VwYXRpb24gfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oeyB1c2VyOiByZXMubmFtZSwgb2NjdXBhdGlvbjogcmVzLmFib3V0IH0pO1xuICAgICAgICBwcm9maWxlUG9wdXBGb3JtLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGNvbnNvbGUubG9nKVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBwcm9maWxlUG9wdXBGb3JtLmNoYW5nZUJ1dHRvblRleHQoXCJTYXZlXCIpXG4gICAgICB9KVxuICB9KTtcblxuY29uc3QgcGxhY2VzUG9wdXBGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9hZGQtY2FyZFwiLCAoZGF0YSkgPT4ge1xuICBwbGFjZXNQb3B1cEZvcm0uY2hhbmdlQnV0dG9uVGV4dChcIlNhdmluZy4uLlwiKVxuICBhcGlcbiAgICAuYWRkQ2FyZCh7IG5hbWU6IGRhdGEubmFtZSwgbGluazogZGF0YS5saW5rIH0pXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgcmVuZGVyQ2FyZChyZXMpO1xuICAgICAgcGxhY2VzUG9wdXBGb3JtLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcGxhY2VzUG9wdXBGb3JtLmNoYW5nZUJ1dHRvblRleHQoXCJTYXZlXCIpXG4gICAgfSlcbn0pO1xuXG5jb25zdCBhdmF0YXJDaGFuZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIi5wb3B1cF90eXBlX2F2YXRhci1jaGFuZ2VcIixcbiAgKGF2YXRhcikgPT4ge1xuICAgXG4gICAgYXZhdGFyQ2hhbmdlUG9wdXAuY2hhbmdlQnV0dG9uVGV4dChcIlNhdmluZy4uLlwiKTtcbiAgICBhcGlcbiAgICAgIC5lZGl0QXZhdGFyKGF2YXRhcilcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKTtcbiAgICAgICAgYXZhdGFyQ2hhbmdlUG9wdXAuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goY29uc29sZS5sb2cpXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGF2YXRhckNoYW5nZVBvcHVwLmNoYW5nZUJ1dHRvblRleHQoXCJTYXZlXCIpXG4gICAgICB9KVxuICB9XG4pO1xuXG5jb25zdCBjb25maXJtRGVsZXRlUG9wdXAgPSBuZXcgUG9wdXBXaXRoU3VibWl0KHtcbiAgcG9wdXBTZWxlY3RvcjogXCIucG9wdXBfdHlwZV9jb25maXJtLWRlbGV0ZVwiLFxuXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChjYXJkKSA9PiB7ICAvLyB0YWtlcyBoYW5kbGVGb3JtU3VibWl0IGFzIGFyZ3VtZW50LCB3aGljaCBjYWxscyBjYXJkIGZyb20gUG9wdXBXaXRoU3VibWl0IGNsYXNzXG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmdldElkKCkpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuICAgICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5sb2cpXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGNvbmZpcm1EZWxldGVQb3B1cC5jbG9zZSgpO1xuICAgICAgfSlcbiAgfSxcbn0pO1xuXG4vLyBFdmVudHNcbm9wZW5Qcm9maWxlTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcHJvZmlsZVBvcHVwRm9ybS5vcGVuKCk7XG4gIGNvbnN0IGluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICB0aXRsZUlucHV0LnZhbHVlID0gaW5mby51c2VyO1xuICBkZXNjcmlwdGlvbklucHV0LnZhbHVlID0gaW5mby5vY2N1cGF0aW9uO1xuICB2YWxpZGF0ZVByb2ZpbGVGb3JtLnJlc2V0VmFsaWRhdGlvbigpO1xuICB2YWxpZGF0ZVByb2ZpbGVGb3JtLmRpc2FibGVCdXR0b24oKTtcbn0pO1xuXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHBsYWNlc1BvcHVwRm9ybS5vcGVuKCk7XG4gIHZhbGlkYXRlUGxhY2VGb3JtLnJlc2V0VmFsaWRhdGlvbigpO1xuICB2YWxpZGF0ZVBsYWNlRm9ybS5kaXNhYmxlQnV0dG9uKCk7XG59KTtcblxuYXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhckNoYW5nZVBvcHVwLm9wZW4oKTtcbiAgdmFsaWRhdGVBdmF0YXJGb3JtLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbnByb2ZpbGVQb3B1cEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnBsYWNlc1BvcHVwRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuaW1hZ2VQcmV2aWV3UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmF2YXRhckNoYW5nZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5jb25maXJtRGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTsiLCJpbXBvcnQgeyBhdmF0YXIgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZVNlbGVjdG9yLCB1c2VyT2NjdXBhdGlvblNlbGVjdG9yLCB1c2VyQXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcm9maWxlT2NjdXBhdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck9jY3VwYXRpb25TZWxlY3Rvcik7XG4gICAgLy8gdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7dXNlckF2YXRhclNlbGVjdG9yfWApO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJBdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdXNlcjogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXG4gICAgICBvY2N1cGF0aW9uOiB0aGlzLl9wcm9maWxlT2NjdXBhdGlvbi50ZXh0Q29udGVudCxcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgdXNlciwgb2NjdXBhdGlvbiwgYXZhdGFyIH0pIHtcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXIgfHwgdGhpcy5fbmFtZTs7XG4gICAgdGhpcy5fcHJvZmlsZU9jY3VwYXRpb24udGV4dENvbnRlbnQgPSBvY2N1cGF0aW9uIHx8IHRoaXMuX29jY3VwYXRpb247O1xuICAgXG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xuICAgICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXIgfHwgdGhpcy5fYXZhdGFyO1xuICB9XG5cbiAgc2V0QXZhdGFyVmlzaWJsZSgpIHtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcbiAgfVxufVxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIC8vIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGNhcmRFbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fdGV4dFwiKTtcbiAgfVxuXG4gIG9wZW4obmFtZSwgbGluaykge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgIFxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gbmFtZTtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoU3VibWl0IGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCB9KSB7XG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b25cIik7XG4gICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIH1cblxuICAgIG9wZW4oY2FyZCkge1xuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgICAgIHRoaXMuX2J1dHRvbi50ZXh0Q29udGVudCA9IFwiWWVzXCI7XG4gICAgICAgIHRoaXMuX2NhcmQgPSBjYXJkO1xuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZXZ0ID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gXCJEZWxldGluZy4uLlwiO1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9jYXJkKTtcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFRlbXBsYXRlU2VsZWN0b3IiLCJ1c2VySWQiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VJY29uIiwidGhpcyIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsIl9jYXJkTGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUljb24iLCJfZGVsZXRlQ2FyZEJ1dHRvbiIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9jYXJkSW1hZ2UiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX25hbWUiLCJfbGluayIsImNhcmRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9jYXJkVGVtcGxhdGVTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZE5hbWUiLCJfbGlrZUNvdW50ZXIiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsInNldExpa2VzIiwiX2xpa2VzIiwiX3VzZXJJZCIsIl9vd25lcklkIiwic3R5bGUiLCJkaXNwbGF5IiwiX2RhdGEiLCJuYW1lIiwibGluayIsImxpa2VzIiwiX2lkIiwib3duZXIiLCJnZXRJZCIsIm5ld0xpa2VzIiwibGlrZUNvdW50ZXIiLCJsZW5ndGgiLCJpc0xpa2VkIiwiY2xhc3NMaXN0IiwiYWRkIiwiZmluZCIsInVzZXIiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWwiLCJpbnB1dEVsIiwiZXJyb3JNZXNzYWdlIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9zZXR0aW5ncyIsImVycm9yRWxlbWVudCIsIl9mb3JtRWwiLCJpZCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9pc0Zvcm1WYWxpZCIsIl9lbmFibGVCdXR0b24iLCJkaXNhYmxlQnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsIl9pbnB1dExpc3QiLCJldmVyeSIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvbiIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJfcG9wdXBFbGVtZW50IiwiX2J1dHRvbiIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlT3ZlcmxheUNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9mb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRzIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJ2YWx1ZSIsImNoYW5nZUJ1dHRvblRleHQiLCJ0ZXh0IiwicmVzZXQiLCJvcGVuUHJvZmlsZU1vZGFsQnV0dG9uIiwiZWRpdFByb2ZpbGVQb3B1cCIsImFkZENhcmRCdXR0b24iLCJhdmF0YXIiLCJ0aXRsZUlucHV0IiwiZGVzY3JpcHRpb25JbnB1dCIsImFkZENhcmRQb3B1cCIsInByZXZpZXdNb2RhbCIsImFkZEF2YXRhclBvcHVwIiwiZ2V0RWxlbWVudEJ5SWQiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJnZXRVc2VySW5mbyIsImVkaXRQcm9maWxlIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFByb2ZpbGUiLCJhZGRDYXJkIiwibGlrZUNhcmQiLCJjYXJkSWQiLCJyZW1vdmVMaWtlIiwiZWRpdEF2YXRhciIsImRlbGV0ZUNhcmQiLCJhdXRob3JpemF0aW9uIiwidXNlckluZm8iLCJ1c2VyTmFtZVNlbGVjdG9yIiwidXNlck9jY3VwYXRpb25TZWxlY3RvciIsInVzZXJBdmF0YXJTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlT2NjdXBhdGlvbiIsIl9hdmF0YXJFbGVtZW50Iiwib2NjdXBhdGlvbiIsInNldFVzZXJJbmZvIiwiX29jY3VwYXRpb24iLCJzZXRVc2VyQXZhdGFyIiwiX2F2YXRhciIsInNldEF2YXRhclZpc2libGUiLCJ2aXNpYmlsaXR5IiwiYWxsIiwidXNlckRhdGEiLCJpbml0aWFsQ2FyZHMiLCJzZWN0aW9uIiwicmVuZGVySXRlbXMiLCJjYXRjaCIsImNvbnNvbGUiLCJsb2ciLCJ2YWxpZGF0ZVByb2ZpbGVGb3JtIiwidmFsaWRhdGVQbGFjZUZvcm0iLCJ2YWxpZGF0ZUF2YXRhckZvcm0iLCJyZW5kZXJDYXJkIiwiY2FyZEVsZW1lbnQiLCJpbWFnZVByZXZpZXdQb3B1cCIsImNvbmZpcm1EZWxldGVQb3B1cCIsImFkZEl0ZW0iLCJjcmVhdGVDYXJkRWxlbWVudCIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbXMiLCJpdGVtIiwicHJlcGVuZCIsIl9pbWFnZSIsIl9pbWFnZUNhcHRpb24iLCJwcm9maWxlUG9wdXBGb3JtIiwiZmluYWxseSIsInBsYWNlc1BvcHVwRm9ybSIsImF2YXRhckNoYW5nZVBvcHVwIiwiY2FyZCIsIl9jYXJkIiwicmVtb3ZlQ2FyZCIsImluZm8iXSwic291cmNlUm9vdCI6IiJ9